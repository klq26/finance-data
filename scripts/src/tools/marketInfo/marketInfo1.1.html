<html style="background: #000;">

<head>
    <title>看盘工具 v1.1</title>
    <link rel="icon"
        href="data:image/png;base64,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"
        type="image/x-icon" />
    <meta http-equiv="Content-Language" content="zh-cn">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style>
        /* 分区标题 */
        .sectionTitle {
            color: #FFFFFF;
            font-size: 46px;
            margin: 4px;
        }

        /* 资金流向值区域 */
        .moneyValueBox {
            display: inline-block;
            width: 636;
        }

        #inlandDealMoney {
            margin-left: 4px;
        }

        #inlandLeverMoney {
            margin-left: 4px;
        }

        #inlandMoneyFlow {
            margin-left: 4px;
        }

        #hkMoneyFlow {
            margin-left: 4px;
        }

        /* 资金流向值 */
        .moneyValue {
            color: #FFFFFF;
            display: inline-block;
            background-color: gray;
            width: 200px;
            font-size: 36;
            height: 48px;
            padding: 0px 0px 0px 2px;
            margin: 0px 4px 1px 4px;
        }

        .moneySubTitle {
            display: inline-flex;
            text-align: left;
            margin-left: 2px;
        }

        .moneySubValue {
            display: inline-block;
            text-align: right;
            float: right;
            margin-right: 2px;
        }

        /* 基金标题 */
        .fundTitle {
            color: #FF9900;
            display: inline-block;
            text-align: center;
            background-color: gray;
            width: 240px;
            font-size: 36;
            margin: 4px;
            height: 48px;
        }

        /* 指数 */
        .index {
            color: #FFFFFF;
            font-size: 36px;
            margin: 4px;
            display: flex;
            height: 48px;
        }

        /* 指数标题 */
        .indexTitle {
            color: #FFFFFF;
            display: inline-block;
            text-align: center;
            background-color: gray;
            width: 240px;
            font-size: 36;
            margin: 4px;
            height: 48px;
        }

        /* 指数值 */
        .indexValue {
            color: #FFFFFF;
            display: inline-block;
            text-align: right;
            background-color: gray;
            padding-right: 4px;
            width: 200px;
            font-size: 36;
            margin: 4px;
            height: 48px;
        }

        /* 指数日变化值 */
        .indexDailyChangeValue {
            color: #FFFFFF;
            display: inline-block;
            text-align: right;
            background-color: gray;
            padding-right: 4px;
            width: 200px;
            font-size: 36;
            margin: 4px;
            height: 48px;
        }

        /* 指数涨跌方向（及额度？） */
        .indexUpDown {
            color: #FFFFFF;
            display: inline-box;
            text-align: center;
            background-color: #333333;
            align-content: center;
            width: 200px;
            height: 48px;
            font-size: 36;
            margin: 4px;
        }

        .indexUpDownIcon {
            width: 48px;
            height: 48px;
        }

        /* 时间戳 */
        #timestamp {
            color: #FFFFFF;
            font-size: 36px;
            margin: 4px;
        }

        /* 涨跌平区 */
        .zdpBarArea {
            display: inline-block;
            color: #FFFFFF;
            font-size: 36px;
            margin-top: 4px;
            margin-left: 4px;
            margin-right: 0px;
            margin-bottom: 0px;
        }

        /* 涨跌平条 */
        .zdpBar {
            display: inline-flex;
            margin-left: 4px;
        }

        /* 涨跌平条 - 涨 */
        .barUp {
            /* display: inline-block; */
            background-color: #DD2200;
            text-align: center;
            min-width: min-content;
        }

        /* 涨跌平条 - 平 */
        .barEqual {
            /* display: inline-block; */
            background-color: gray;
            text-align: center;
            min-width: min-content;
        }

        /* 涨跌平条 - 跌 */
        .barDown {
            /* display: inline-block; */
            background-color: #009933;
            text-align: center;
            min-width: min-content;
        }

        /* 涨跌分布 */
        #zdfb {
            width: 892px;
            display: inline-flex;
            flex-wrap: nowrap;
            flex-direction: column;
            height: 0px;
            justify-content: flex-end;
            align-items: center;
        }

        /* 柱状条区域 */
        #zdpValueBarArea {
            width: 852px;
            display: inline-flex;
            flex-wrap: nowrap;
            justify-content: space-around;
            align-items: flex-end;
        }

        /* 柱状条 + 个股数的容器 */
        .zdpValueBox {
            display: inline-block;
            flex-wrap: nowrap;
            width: 48px;
            justify-content: space-between;
            align-items: flex-end;
        }

        /* 个股数 */
        .zdpValue {
            display: inline-flex;
            color: #fff;
            width: 48px;
            font-size: 36px;
            justify-content: center;
        }

        /* 柱状条 */
        .zdpValueBar {
            display: inline-flex;
            color: #fff;
            width: 48px;
            justify-content: center;
            background-color: pink;
        }

        /* 分割线 */
        #zdpSplitLine {
            height: 2px;
            width: 892px;
            background-color: #fff;
        }

        /* 涨跌幅度标题区域 */
        #zdpTitleBarArea {
            width: 892px;
            display: inline-flex;
            flex-wrap: nowrap;
            justify-content: space-between;
        }

        /* 涨跌幅度标题 */
        .zdpTitle {
            display: inline-flex;
            color: #fff;
            width: 40px;
            font-size: 30px;
            justify-content: center;
        }
    </style>
    <!-- <script type="text/javascript" src="zdfb.json"></script> -->
    <!-- 百度压缩版 jQuery -->
    <script src="http://libs.baidu.com/jquery/2.1.4/jquery.min.js"></script>
    <!-- 自定义脚本 -->
    <script type="text/javascript">
        // 是否工作日
        var isWorkingDay = true;
        // 涨跌平条宽
        var zdpBarWidth = 624;
        // 显示类型
        var showType = 1;
        var sections = ["moneyFlow", "zdp", "zdfb", "chinaIndexs", "asianIndexs", "euroIndexs", "americaIndexs", "goods", "bonds", "exchanges"];
        // 上涨 icon
        var upIcon = "data:image/png;base64,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";
        // 下跌 icon
        var downIcon = "data:image/png;base64,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"

        ///////////////////////////////////////////////////////////////////////////////////////////////////
        /// REQUEST
        ///////////////////////////////////////////////////////////////////////////////////////////////////

        // 请求资金流向数据
        function requestMoneyFlowV2(isForce=false) {
            var todayStr = todayString('/');
            if (isForce || isWorkingDay && (isDuringDate(todayStr + ' 9:00', todayStr + ' 11:35') || isDuringDate(todayStr + ' 13:00', todayStr + ' 16:20'))) {
                $.ajax({
                    url: "http://112.125.25.230/api/moneyinfo",
                    type: "GET",
                    contentType: "application/json",
                    dataType: "json",
                    async: true,
                    success: function (data) {
                        // 沪深两市成交额（亿）
                        updateMoneyFlowV2(data['data'][0], 'inlandDealMoney', false);
                        // 融资融券余额（亿）
                        updateMoneyFlowV2(data['data'][1], 'inlandLeverMoney', false);
                        // 沪深资金净流入（亿）
                        updateMoneyFlowV2(data['data'][2], 'inlandMoneyFlow', true);
                        // 北向资金净流入（亿）
                        updateMoneyFlowV2(data['data'][3], 'hkToInlandMoneyFlow', true);
                        // 南向资金净流入（亿）
                        updateMoneyFlowV2(data['data'][4], 'InlandTohkMoneyFlow', true);
                    }
                });
            }
        }
        // 请求指数的涨跌平盘分布情况
        function requestZDPDataV2(isForce=false) {
            var todayStr = todayString('/');
            if (isForce || isWorkingDay && (isDuringDate(todayStr + ' 9:25', todayStr + ' 11:35') || isDuringDate(todayStr + ' 13:00', todayStr + ' 15:05'))) {
                $.ajax({
                    url: "http://112.125.25.230/api/zdpinfo",
                    type: "GET",
                    contentType: "application/json",
                    dataType: "json",
                    async: true,
                    success: function (data) {
                        for (var key in data['data']) {
                            // 涨跌平盘
                            if (data['data'][key]['symbol'] == 'zdp') {
                                indexZDPs = data['data'][key]['value']
                                for (var idx in indexZDPs) {
                                    updateZDPBarV2(indexZDPs[idx]);
                                }
                            }
                            // 涨跌停板
                            if (data['data'][key]['symbol'] == 'zdt') {
                                zdt = data['data'][key]['value']
                                updateZDTV2(zdt);
                            }
                            // 涨跌分布
                            if (data['data'][key]['symbol'] == 'zdfb') {
                                zdfb = data['data'][key]['value']
                                updateZDChartV2(zdfb);
                            }
                        }
                    }
                });
            }
            
        }
        // 请求中国指数（含香港）
        function requestChinaIndexsV2(isForce=false) {
            var todayStr = todayString('/');
            if (isForce || isWorkingDay && (isDuringDate(todayStr + ' 9:00', todayStr + ' 11:35') || isDuringDate(todayStr + ' 13:00', todayStr + ' 16:20'))) {
                $.ajax({
                url: "http://112.125.25.230/api/indexs?area=china",
                type: "GET",
                contentType: "application/json",
                dataType: "json",
                async: true,
                success: function (data) {
                    updateIndexInfosV2(data['data'], 'chinaIndexs');
                }
            });
            // // 取华宝油气
            // $.ajax({
            //     url: "http://push2.eastmoney.com/api/qt/stock/details/get?secid=0.162411&fields1=f1,f2,f3,f4&fields2=f51,f52,f53,f54,f55&pos=-11&cb=updateInnerMarketFunds",
            //     type: "GET",
            //     contentType: "application/x-javascript",
            //     dataType: "script",
            //     async: true
            // });
            // // 取中概互联
            // $.ajax({
            //     url: "http://push2.eastmoney.com/api/qt/stock/details/get?secid=1.513050&fields1=f1,f2,f3,f4&fields2=f51,f52,f53,f54,f55&pos=-11&cb=updateInnerMarketFunds",
            //     type: "GET",
            //     contentType: "application/x-javascript",
            //     dataType: "script",
            //     async: true
            // });
            }
        }
        // 请求亚洲指数
        function requestAsianIndexsV2(isForce=false) {
            var todayStr = todayString('/');
            if (isForce || isWorkingDay && (isDuringDate(todayStr + ' 9:00', todayStr + ' 11:35') || isDuringDate(todayStr + ' 13:00', todayStr + ' 16:20'))) {
                $.ajax({
                    url: "http://112.125.25.230/api/indexs?area=asian",
                    type: "GET",
                    contentType: "application/json",
                    dataType: "json",
                    async: true,
                    success: function (data) {
                        updateIndexInfosV2(data['data'], 'asianIndexs');
                    }
                });
            }
        }
        // 请求欧洲指数
        function requestEuroIndexsV2(isForce=false) {
            var todayStr = todayString('/');
            // 16:00 - 24:00 后，从 00:01 开始，todayString 已经是第二天凌晨了，所以直接计算 00:00 ~ 2:30 间隔即可
            if (isForce || isWorkingDay && (isDuringDate(todayStr + ' 16:00', todayStr + ' 23:59') || isDuringDate(todayStr + ' 00:00', todayStr + ' 2:30'))) {
                $.ajax({
                    url: "http://112.125.25.230/api/indexs?area=euro",
                    type: "GET",
                    contentType: "application/json",
                    dataType: "json",
                    async: true,
                    success: function (data) {
                        updateIndexInfosV2(data['data'], 'euroIndexs');
                    }
                });
            }
        }
        // 请求美洲指数
        function requestAmericaIndexsV2(isForce=false) {
            var todayStr = todayString('/');
            // 22:00 - 24:00 后，从 00:01 开始，todayString 已经是第二天凌晨了，所以直接计算 00:00 ~ 5:30 间隔即可
            if (isForce || isWorkingDay && (isDuringDate(todayStr + ' 22:00', tomorrowStr + '23:59') || isDuringDate(todayStr + ' 00:00', tomorrowStr + '5:30'))) {
                $.ajax({
                    url: "http://112.125.25.230/api/indexs?area=america",
                    type: "GET",
                    contentType: "application/json",
                    dataType: "json",
                    async: true,
                    success: function (data) {
                        updateIndexInfosV2(data['data'], 'americaIndexs');
                    }
                });
            }
            
        }
        // 请求期货&外汇
        function requestGoodsAndExchangesV2(isForce=false) {
            if (isForce || isWorkingDay) {
                $.ajax({
                    url: "http://112.125.25.230/api/goods_and_exchanges",
                    type: "GET",
                    contentType: "application/json",
                    dataType: "json",
                    async: true,
                    success: function (data) {
                        updateIndexInfosV2(data['data']['goods'], 'goods', 3);
                        updateIndexInfosV2(data['data']['exchanges'], 'exchanges', 4);
                    }
                });
            }
        }
        // 请求债券
        function requestBondsV2(isForce=false) {
            $.ajax({
                url: "http://112.125.25.230/api/bondinfo",
                type: "GET",
                contentType: "application/json",
                dataType: "json",
                async: true,
                success: function (data) {
                    // 货币基金
                    updateIndexInfosV2(data['data'][0]['value'], 'bonds', 3);
                    // 二级债券组合
                    updateIndexInfosV2(data['data'][1]['value'], 'bonds', 3);
                    // 国债收益率
                    updateIndexInfosV2(data['data'][2]['value'], 'bonds', 3);
                }
            });
        }

        ///////////////////////////////////////////////////////////////////////////////////////////////////
        /// RENDER
        ///////////////////////////////////////////////////////////////////////////////////////////////////

        // 更新各国指数数据
        function updateIndexInfosV2(data, areaId, demical = 2) {
            var datalist = data;
            for (var key in datalist) {
                // 指数数据
                var item = datalist[key];
                // id
                var elementId = "#" + item['indexCode'];
                // 代码
                var symbol = item['indexCode'];
                // 当前价
                var current = parseFloat(item['current']).toFixed(demical);
                // 前收盘
                var lastClose = parseFloat(item['lastClose']).toFixed(demical);
                // 名称
                var name = item['indexName'];
                // if (symbol.indexOf('CNH') > 0) {
                //     current = parseFloat(item['current']);
                //     lastClose = current - parseFloat(item['lastClose']);
                // }
                // 与昨日收盘对比
                var dailyChangedValue = parseFloat(item['dailyChangValue']).toFixed(demical);
                if(isNaN(dailyChangedValue)) {
                    dailyChangedValue = 0.0.toFixed(demical);
                }
                var dailyChangedRate = item['dailyChangRate']
                // 上次更新的值
                lastValue = $(elementId).val();
                // 如果没有上次值，则说明是第一次进入页面，不计算涨跌
                if (typeof lastValue == "undefined") {
                    lastValue = current;
                }
                // 和上次查询进行比较（非和昨天收盘价比较，而是和上次日内查询进行比较）
                refreshChangedTag = "-";
                refreshChangedColor = "#FFFFFF";
                refreshChangedValue = 0.00;
                var refreshChangedIcon = null;
                if (current != lastValue) {
                    refreshChangedIcon = document.createElement('img');
                    refreshChangedIcon.className = "indexUpDownIcon";
                    if (current > lastValue) {
                        refreshChangedColor = getUpDownColoredText(1);// "#DD2200";
                        refreshChangedIcon.src = upIcon;
                    } else if (current < lastValue && current != 0) {
                        refreshChangedColor = getUpDownColoredText(-1);//"#009933";
                        refreshChangedIcon.src = downIcon;
                    }
                } else {
                    refreshChangedTag = "-";
                    refreshChangedColor = "#FFFFFF";
                }
                refreshChangedValue = (current - lastValue).toFixed(demical);
                // 日间升降指标（和昨天收盘比较，决定整条数据的整体颜色）
                changedColor = "";
                if (parseFloat(current) > parseFloat(lastClose)) {
                    changedColor = getUpDownColoredText(1);//"#DD2200";

                } else if (parseFloat(current) < parseFloat(lastClose)) {
                    changedColor = getUpDownColoredText(-1);//"#009933";
                } else {
                    changedColor = "#808080";
                }
                if (refreshChangedValue > 0) {
                    refreshChangedValue = "+" + refreshChangedValue;
                }

                // 取出 index 元素
                var indexElement = document.getElementById(item['indexCode']);
                if (indexElement == null) {
                    indexElement = document.createElement('p');
                    indexElement.id = item['indexCode'];
                    indexElement.className = 'index';
                    document.getElementById(areaId).appendChild(indexElement);
                }
                indexElement.innerHTML = "";
                // 标题
                var title = document.createElement('div');
                title.className = "indexTitle";
                title.innerText = showType == 1 ? name : symbol;
                indexElement.appendChild(title);
                // 点数
                var indexValue = document.createElement('div');
                indexValue.className = "indexValue";
                var value = undefined;
                if(typeof item['current'] == 'string') {
                    indexValue.innerText = item['current'];
                } else {
                    indexValue.innerText = current;
                }
                indexValue.style.setProperty('background-color', changedColor);
                indexElement.appendChild(indexValue);
                // 点数
                var changeRate = document.createElement('div');
                changeRate.className = "indexDailyChangeValue";
                changeRate.innerText = showType == 1 ? dailyChangedRate : dailyChangedValue;
                changeRate.style.setProperty('background-color', changedColor);
                indexElement.appendChild(changeRate);
                // 变化方向
                var upDown = document.createElement('div');
                upDown.className = "indexUpDown";
                upDown.style.setProperty('color', refreshChangedColor);
                if (showType == 1) {
                    if (refreshChangedIcon != null) {
                        upDown.appendChild(refreshChangedIcon);
                        refreshChangedIcon = null;
                    } else {
                        upDown.innerHTML = refreshChangedTag;
                    }

                    upDown.style.setProperty('text-align', 'center');
                } else {
                    upDown.innerHTML = refreshChangedValue;
                    upDown.style.setProperty('text-align', 'right');
                    upDown.style.setProperty('padding-right', '4px');
                }
                indexElement.appendChild(upDown);
                // 保存本次数值
                $(elementId).val(current);
                // 更新动画
                $(upDown).fadeOut({ duration: 300 });
                $(upDown).fadeIn({ duration: 300 });
                $(upDown).fadeOut({ duration: 300 });
                $(upDown).fadeIn({ duration: 300 });
            }
        }
        // 更新涨跌平
        function updateZDPBarV2(data) {
            idKey = data['symbol']
            name = data['name']
            up = parseInt(data['z'])
            equal = parseInt(data['p'])
            down = parseInt(data['d'])
            var all = up + equal + down;
            // 涨跌平条
            var zdpBarArea = document.getElementById(idKey);
            if (zdpBarArea == null) {
                zdpBarArea = document.createElement('div');
                zdpBarArea.id = idKey
                zdpBarArea.className = "zdpBarArea";
            }
            // 标题
            var title = document.getElementById(idKey + '_title');
            if (title == null) {
                title = document.createElement('div');
                title.id = idKey + '_title';
                title.className = "indexTitle";
                zdpBarArea.appendChild(title);
            }
            title.innerText = name
            // 图形区
            var zdpBar = document.getElementById(idKey + '_bar');
            if (zdpBar == null) {
                zdpBar = document.createElement('div');
                zdpBar.id = idKey + '_bar'
                zdpBar.className = "zdpBar";
                zdpBarArea.appendChild(zdpBar);
            }
            var upStocks = document.getElementById(idKey + '_up');
            if (upStocks == null) {
                upStocks = document.createElement('div');
                upStocks.id = idKey + '_up'
                upStocks.className = "barUp";
                zdpBar.appendChild(upStocks);
            }
            var equalStocks = document.getElementById(idKey + '_equal');
            if (equalStocks == null) {
                equalStocks = document.createElement('div');
                equalStocks.id = idKey + '_equal'
                equalStocks.className = "barEqual";
                zdpBar.appendChild(equalStocks);
            }
            var downStocks = document.getElementById(idKey + '_down');
            if (downStocks == null) {
                downStocks = document.createElement('div');
                downStocks.id = idKey + '_down'
                downStocks.className = "barDown";
                zdpBar.appendChild(downStocks);
            }
            document.getElementById('zdpbar').appendChild(zdpBarArea);
            // 刷新一下宽度
            equalStocks.innerHTML = "";
            upStocks.innerHTML = "";
            downStocks.innerHTML = "";
            upStocks.style.setProperty('width', 0);
            equalStocks.style.setProperty('width', 0);
            downStocks.style.setProperty('width', 0);
            equalStocks.innerHTML = equal;
            upStocks.innerHTML = up;
            downStocks.innerHTML = down;
            // console.log(idKey);
            // 生成涨跌平条的全面数据
            var upDict = {
                "count": up,
                "calW": parseInt(up / all * zdpBarWidth),
                "minW": parseInt($(upStocks).css('width')),
                "isCalTooSmall": parseInt(up / all * zdpBarWidth) < parseInt($(upStocks).css('width')) ? true : false,
                "finalW": parseInt(up / all * zdpBarWidth) > parseInt($(upStocks).css('width')) ? parseInt(up / all * zdpBarWidth) : parseInt($(upStocks).css('width'))
            };
            var equalDict = {
                "count": equal,
                "calW": parseInt(equal / all * zdpBarWidth),
                "minW": parseInt($(equalStocks).css('width')),
                "isCalTooSmall": parseInt(equal / all * zdpBarWidth) < parseInt($(equalStocks).css('width')) ? true : false,
                "finalW": parseInt(equal / all * zdpBarWidth) > parseInt($(equalStocks).css('width')) ? parseInt(equal / all * zdpBarWidth) : parseInt($(equalStocks).css('width'))
            };
            var downDict = {
                "count": down,
                "calW": parseInt(down / all * zdpBarWidth),
                "minW": parseInt($(downStocks).css('width')),
                "isCalTooSmall": parseInt(down / all * zdpBarWidth) < parseInt($(downStocks).css('width')) ? true : false,
                "finalW": parseInt(down / all * zdpBarWidth) > parseInt($(downStocks).css('width')) ? parseInt(down / all * zdpBarWidth) : parseInt($(downStocks).css('width'))
            };
            var dictArray = [upDict, equalDict, downDict];
            var leftCount = 0;
            var leftWidth = zdpBarWidth;
            // 如果原比例计算的宽度不足以显示内容，则保留字段的最小视觉宽度，放弃之前的三者共同计算比例
            // 每去掉一个比例条，就要相应剪掉其对应的宽度，剩下的条重新计算比例，重新共享宽度
            for (var idx in dictArray) {
                var currentBar = dictArray[idx];
                if (!currentBar['isCalTooSmall']) {
                    leftCount = leftCount + currentBar['count'];
                } else {
                    leftWidth = leftWidth - currentBar['finalW'];
                }
            }
            // 根据是最小宽度还是计算宽度，来决定每个元素的最终绘制宽度
            if (upDict['isCalTooSmall']) {
                $(upStocks).css('width', parseInt(upDict['finalW']));
            } else {
                $(upStocks).css('width', parseInt(upDict['count']) / leftCount * leftWidth);
            }

            if (equalDict['isCalTooSmall']) {
                $(equalStocks).css('width', parseInt(equalDict['finalW']));
            } else {
                $(equalStocks).css('width', parseInt(equalDict['count']) / leftCount * leftWidth);
            }

            if (downDict['isCalTooSmall']) {
                $(downStocks).css('width', parseInt(downDict['finalW']));
            } else {
                $(downStocks).css('width', parseInt(downDict['count']) / leftCount * leftWidth);
            }
            // console.log(upStocks,equalStocks,downStocks);
            // console.log(upDict,equalDict,downDict);
            // // 更新动画
            var zdpBar = zdpBarArea.getElementsByClassName('zdpbar')[0];
            $(zdpBar).fadeOut({ duration: 300 });
            $(zdpBar).fadeIn({ duration: 300 });
            $(zdpBar).fadeOut({ duration: 300 });
            $(zdpBar).fadeIn({ duration: 300 });
        }
        // 更新涨跌停
        function updateZDTV2(data) {
            // 涨跌停
            var zdtData = data;
            var zdtBar = document.getElementById("zdt");
            zdtBar.className = "index";
            zdtBar.innerHTML = "";
            // 标题
            var title = document.createElement('div');
            title.className = "indexTitle";
            title.innerText = "涨跌停板";
            title.style.setProperty('height', 48);
            zdtBar.appendChild(title);
            // 涨停
            var box = document.createElement('div');
            box.className = "moneyValueBox";
            box.style.setProperty('margin-top', 4);
            moneyFlow.appendChild(box);

            var up10 = document.createElement('div');
            up10.className = "moneyValue";
            var num = parseFloat(zdtData[0]['value']);
            var subTitle = document.createElement('span');
            subTitle.className = "moneySubTitle";
            subTitle.innerText = "涨停";
            var subValue = document.createElement('span');
            subValue.className = "moneySubValue";
            subValue.innerText = num;
            up10.appendChild(subTitle);
            up10.appendChild(subValue);
            up10.style.setProperty('background-color', getUpDownColoredText(1));//"#DD2200");
            up10.style.setProperty('width','48%');
            box.appendChild(up10);
            // 跌停
            var down10 = document.createElement('div');
            down10.className = "moneyValue";
            var num = parseFloat(zdtData[1]['value']);
            var subTitle = document.createElement('span');
            subTitle.className = "moneySubTitle";
            subTitle.innerText = "跌停";
            var subValue = document.createElement('span');
            subValue.className = "moneySubValue";
            subValue.innerText = num;
            down10.appendChild(subTitle);
            down10.appendChild(subValue);
            down10.style.setProperty('background-color', getUpDownColoredText(-1));//"#009933");
            down10.style.setProperty('width','48%');
            box.appendChild(down10);
            zdtBar.appendChild(box);

            // 更新动画
            $(box).fadeOut({ duration: 300 });
            $(box).fadeIn({ duration: 300 });
            $(box).fadeOut({ duration: 300 });
            $(box).fadeIn({ duration: 300 });
        }
        // 更新涨跌停板 & 涨跌分布
        function updateZDChartV2(data) {
            // value bar
            var zdpValueBarArea = document.getElementById('zdpValueBarArea');
            zdpValueBarArea.innerHTML = "";
            var values = data;
            var index = 0;
            var maxCount = 0;
            values.forEach(element => {
                var count = parseInt(element);
                if (count > maxCount) {
                    maxCount = count;
                }
                var barColor = "";
                if (index >= 5) {
                    barColor = getUpDownColoredText(-1);//"#009933";
                } else {
                    barColor = getUpDownColoredText(1);//"#DD2200";
                }
                // 柱状条 + 个股数的容器
                var valueBox = document.createElement('div');
                valueBox.className = 'zdpValueBox';
                // 柱状条
                var bar = document.createElement('div');
                bar.className = 'zdpValueBar';
                bar.style.setProperty('height', parseInt(element) / 10);
                bar.style.setProperty('background-color', barColor);
                // 个股数
                var value = document.createElement('div');
                value.className = 'zdpValue';
                value.innerHTML = element;

                valueBox.appendChild(value);
                valueBox.appendChild(bar);
                zdpValueBarArea.appendChild(valueBox);
                index++;
            });
            // title bar
            var zdpTitleBarArea = document.getElementById('zdpTitleBarArea');
            zdpTitleBarArea.innerHTML = "";
            var titles = ['-10%', '-8%', '-6%', '-4%', '-2%', '0', '2%', '4%', '6%', '8%', '10%'].reverse();
            titles.forEach(element => {
                var title = document.createElement('div');
                title.className = 'zdpTitle';
                title.innerHTML = element;
                zdpTitleBarArea.appendChild(title);
            });
            var zdfbArea = document.getElementById('zdfb');
            // 用不着太高的时候就别站太大空间
            zdfbArea.style.setProperty('height', maxCount / 10 + 110);
            // 更新动画
            $(zdpValueBarArea).fadeOut({ duration: 300 });
            $(zdpValueBarArea).fadeIn({ duration: 300 });
            $(zdpValueBarArea).fadeOut({ duration: 300 });
            $(zdpValueBarArea).fadeIn({ duration: 300 });
        }
        // 更新沪深两市资金净流向
        function updateMoneyFlowV2(data, divId, needChangeColor=true) {
            // 更新
            var divElement = document.getElementById(divId);
            divElement.innerHTML = "";
            // 标题
            var title = document.createElement('div');
            title.className = "indexTitle";
            title.style.setProperty('height', 48 * 2 + 2);
            title.innerText = data['name'];
            divElement.appendChild(title);
            // 数值区
            var valueBox = document.createElement('div');
            valueBox.className = "moneyValueBox";
            divElement.appendChild(valueBox);
            // 值
            for(var idx in data['value']) {
                item = data['value'][idx];
                var value = document.createElement('div');
                value.className = "moneyValue";
                var num = undefined;
                if(typeof item['value'] == 'string') {
                    var num = item['value'];
                } else {
                    var num = parseFloat(item['value']).toFixed(1);
                }
                var subTitle = document.createElement('span');
                subTitle.className = "moneySubTitle";
                subTitle.innerText = item['name'];
                var subValue = document.createElement('span');
                subValue.className = "moneySubValue";
                subValue.innerText = num;
                value.appendChild(subTitle);
                value.appendChild(subValue);
                if(needChangeColor) {
                    value.style.setProperty('background-color', getUpDownColoredText(num))
                }
                valueBox.appendChild(value);
            }
            // 更新动画
            $(valueBox).fadeOut({ duration: 300 });
            $(valueBox).fadeIn({ duration: 300 });
            $(valueBox).fadeOut({ duration: 300 });
            $(valueBox).fadeIn({ duration: 300 });
        }

        ///////////////////////////////////////////////////////////////////////////////////////////////////
        /// TOOL
        ///////////////////////////////////////////////////////////////////////////////////////////////////

        // 判断是否在某一时间段之内
        function isDuringDate(beginDateStr, endDateStr) {
            console.log(beginDateStr, endDateStr);
            var curDate = new Date(),
                beginDate = new Date(beginDateStr),
                endDate = new Date(endDateStr);
            if (curDate >= beginDate && curDate <= endDate) {
                return true;
            }
            return false;
        }
        // 显示涨跌红绿色字符
        function getUpDownColoredText(num) {
            if (num > 0) {
                return '#DD2200';
            } else if (num < 0) {
                return '#009933';
            } else {
                return '#808080';
            }
        }
        // 时间前置补 0
        function prefixInteger(num, length) {
            return (Array(length).join('0') + num).slice(-length);
        }
        // 判断今天是不是工作日
        function todayIsWorkingDay() {
            var todayStr = todayString();
            $.ajax({
                url: "http://112.125.25.230/api/today",
                type: "GET",
                contentType: "application/json",
                dataType: "json",
                async: false,
                success: function (data) {
                    // weekday weekend holiday
                    dayType = data['data']['weekday'];
                    if(dayType == '1') {
                        isWorkingDay = true;
                    } else {
                        isWorkingDay = false;
                    }
                }
            });

            return true;
            // {"20200229":"1"}
        }
        // 今天日期字符串(2020/01/01 或 20200101)
        function todayString(sep='') {
            var date = new Date();
            // yesterdayString
            // date.setTime(date.getTime() - 24*60*60*1000);
            // tomorrowString
            // date.setTime(date.getTime() + 24*60*60*1000);
            var year = date.getFullYear();
            var month = prefixInteger(date.getMonth() + 1, 2);
            var day = prefixInteger(date.getDate(), 2);
            return todayStr = year + sep + month + sep + day;
        }
        // 显示时间
        function showtime() {
            var date = new Date();
            var year = date.getFullYear();
            var month = prefixInteger(date.getMonth() + 1, 2);
            var day = prefixInteger(date.getDate(), 2);
            var hh = prefixInteger(date.getHours(), 2);
            var mi = prefixInteger(date.getMinutes(), 2);
            var ss = prefixInteger(date.getSeconds(), 2);
            var dayTag = "日一二三四五六".charAt(date.getDay());
            var wk = "周" + dayTag;
            var status = "";
            var statusColor = "#FFFF00";
            $("#timestamp").html(year + "-" + month + "-" + day + " " + hh + ":" + mi + ":" + ss + " " + wk);
        }
        // 显隐对应区域
        function showHideArea(element) {
            if ($(element).is(':hidden')) {
                $(element).show({ duration: 300 })

            } else {
                $(element).hide({ duration: 300 });

            }
        }
        // 切换显示信息类型
        function changeShowType(element) {
            if (showType == 1) {
                showType = 2;
            } else {
                showType = 1;
            }
            // 强制刷新数据，曲线解决问题
            refreshPage();
        }
        // 页面刷新
        function refreshPage() {
            // 资金流向
            requestMoneyFlowV2(isForce=true);
            // A股涨跌平
            requestZDPDataV2(isForce=true);
            // 各国指数
            requestChinaIndexsV2(isForce=true);
            requestAsianIndexsV2(isForce=true);
            requestEuroIndexsV2(isForce=true);
            requestAmericaIndexsV2(isForce=true);
            // 期货 & 外汇
            requestGoodsAndExchangesV2(isForce=true);
            // 债券
            requestBondsV2(isForce=true);
        }
        // 初始化
        $(document).ready(function () {
            // 初始化页面
            refreshPage();
            // 是否工作日
            todayIsWorkingDay();
            // 初始化时间
            showtime();
            // 定时刷新
            // 显示时间 1s
            setInterval(showtime, 1000);
            // 资金流 60s
            setInterval(requestMoneyFlowV2, 60 * 1000);
            // 涨跌平 60s
            setInterval(requestZDPDataV2, 60 * 1000);
            // 指数 15s
            setInterval(requestChinaIndexsV2, 15 * 1000);
            setInterval(requestAsianIndexsV2, 15 * 1000);
            setInterval(requestEuroIndexsV2, 15 * 1000);
            setInterval(requestAmericaIndexsV2, 15 * 1000);
            // 期货&外汇 15s
            setInterval(requestGoodsAndExchangesV2, 15 * 1000);
            // 债券几乎不变，无需定时刷新
            // setInterval(requestGoodsAndExchangesV2, 60 * 1000);
        });
    </script>
</head>

<body style="width: 900px;">
    <!-- 时间区 -->
    <p id="timestamp" style="font-size: 36; color: #FAFAFA;">时间</p>
    <hr />
    <!-- 资金流向区 -->
    <p class="sectionTitle" onclick="showHideArea(moneyFlow)">大陆及沪港通资金流向</p>
    <div id="moneyFlow" style="color: #fff;">
        <div id="inlandDealMoney"></div>
        <div id="inlandLeverMoney"></div>
        <div id="inlandMoneyFlow"></div>
        <div id="hkToInlandMoneyFlow"></div>
        <div id="InlandTohkMoneyFlow"></div>
    </div>
    <hr />
    <!-- 涨跌平盘条形区 -->
    <p class="sectionTitle" onclick="showHideArea(zdp)">指数涨跌分布</p>
    <!-- 指数涨跌平条 -->
    <div id="zdp">
        <!-- 涨跌平条 -->
        <div id="zdpbar"></div>
        <!-- 涨跌停板 -->
        <div id="zdt"></div>
        <!-- 涨跌分布 -->
        <div id="zdfb">
            <div id="zdpValueBarArea"></div>
            <div id="zdpSplitLine"></div>
            <div id="zdpTitleBarArea"></div>
        </div>
    </div>
    <hr />
    <!-- 指数区 -->
    <div id="index">
        <!-- 中国 -->
        <p class="sectionTitle" onclick="showHideArea(chinaIndexs)">中国大陆及港台地区</p>
        <div id="chinaIndexs" onclick="changeShowType(this)">
        </div>
        <hr />
        <!-- 中国台湾，亚洲新兴 & 欧洲，美洲等 -->
        <p class="sectionTitle" onclick="showHideArea(asianIndexs)">亚洲地区</p>
        <div id="asianIndexs" onclick="changeShowType(this)">
        </div>
        <hr />
        <!-- 欧洲 -->
        <p class="sectionTitle" onclick="showHideArea(euroIndexs)">欧洲地区</p>
        <div id="euroIndexs" onclick="changeShowType(this)">
        </div>
        <hr />
        <!-- 美洲 -->
        <p class="sectionTitle" onclick="showHideArea(americaIndexs)">美洲地区</p>
        <div id="americaIndexs" onclick="changeShowType(this)">
        </div>
    </div>
    <hr />
    <!-- 期货 -->
    <p class="sectionTitle" onclick="showHideArea(goods)">股指及商品期货</p>
    <div id="goods" onclick="changeShowType(this)">
    </div>
    <hr />
    <!-- 外汇 -->
    <p class="sectionTitle" onclick="showHideArea(exchanges)">外汇牌价</p>
    <div id="exchanges" onclick="changeShowType(this)">
    </div>
    <hr />
    <!-- 固收债券 -->
    <p class="sectionTitle" onclick="showHideArea(bonds)">固定收益债券</p>
    <div id="bonds" onclick="changeShowType(this)">
    </div>
    </div>
</body>
</html>